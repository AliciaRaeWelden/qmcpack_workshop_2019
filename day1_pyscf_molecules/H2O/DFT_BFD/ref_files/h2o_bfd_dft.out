#INFO: **** input file is /home/abenali/Work/WorkShop/qmcpack_workshop_2019/day1_pyscf_molecules/H2O/DFT_BFD/ref_files/h2o_bfd_dft.py ****
#!/usr/bin/env python

from pyscf import gto
from pyscf import scf, dft, df

mol = gto.Mole()
mol.verbose = 5
mol.atom =''' 
  H             0.00000000       0.75720000      -0.46920000
  H             0.00000000      -0.75720000      -0.46920000
  O             0.00000000       0.00000000       0.11730000
 '''
mol.unit='A'
mol.basis = 'bfd_vtz'
mol.ecp = 'bfd'
mol.spin=0 #Value of S where the spin multiplicity is 2S+1
mol.build()



#Hartree Fock
#mf = scf.ROHF(mol)

#DFT
mf = dft.ROKS(mol)
mf.xc ='b3lyp' 

e_scf=mf.kernel()

#Section for QMCPACK
title="H2O_DFT_BFD"
from PyscfToQmcpack import savetoqmcpack
savetoqmcpack(mol,mf,title=title)

#INFO: ******************** input file end ********************


System: ('Linux', 'abenali', '4.15.0-48-generic', '#51-Ubuntu SMP Wed Apr 3 08:28:49 UTC 2019', 'x86_64', 'x86_64')  Threads 8
Python 2.7.15rc1 (default, Nov 12 2018, 14:31:15) 
[GCC 7.3.0]
numpy 1.14.0  scipy 1.0.0
Date: Sun May 12 00:54:31 2019
PySCF version 1.6.1
PySCF path  /home/abenali/Work/src/pyscf/pyscf
GIT ORIG_HEAD 2cd183cacbe44dc607e325b3aab196fd09b24068
GIT HEAD      ref: refs/heads/dev
GIT dev branch  09e76a37bba1258f387edc9bb3c45eb68014f488

[CONFIG] conf_file None
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 3
[INPUT] num. electrons = 8
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = A
[INPUT]  1 H      0.000000000000   0.757200000000  -0.469200000000 AA    0.000000000000   1.430900621521  -0.886659497646 Bohr
[INPUT]  2 H      0.000000000000  -0.757200000000  -0.469200000000 AA    0.000000000000  -1.430900621521  -0.886659497646 Bohr
[INPUT]  3 O      0.000000000000   0.000000000000   0.117300000000 AA    0.000000000000   0.000000000000   0.221664874411 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] H
[INPUT] 0    0    [9    /1   ]  10.180385         -0.000452
                                4.426254          0.029966
                                1.924458          0.097443
                                0.836721          0.169833
                                0.363792          0.277612
                                0.15817           0.230695
                                0.06877           0.057693
                                0.0299            -0.002119
                                0.013             0.000706
[INPUT] 0    0    [1    /1   ]  0.170654             1
[INPUT] 1    0    [9    /1   ]  6.264991          -0.000347
                                2.409612          -0.009395
                                0.926774          -0.013929
                                0.356451          -0.018235
                                0.137097          -0.01153
                                0.05273           -0.000238
                                0.020281          -5.4e-05
                                0.0078            -0.000913
                                0.003             0.001242
[INPUT] 1    0    [1    /1   ]  0.495357             1
[INPUT] 2    0    [1    /1   ]  0.955745             1
[INPUT] O
[INPUT] 0    0    [9    /1   ]  54.775216         -7.6e-05
                                25.616801         0.000407
                                11.980245         0.012024
                                5.602818          -0.128627
                                2.620277          0.019567
                                1.225429          0.295926
                                0.573098          0.453752
                                0.268022          0.304848
                                0.125346          0.055741
[INPUT] 0    0    [1    /1   ]  1.686633             1
[INPUT] 0    0    [1    /1   ]  0.237997             1
[INPUT] 1    0    [9    /1   ]  21.217318         0.004679
                                10.620108         0.039899
                                5.315785          0.082308
                                2.660761          0.161134
                                1.331816          0.242835
                                0.666627          0.281879
                                0.333673          0.255999
                                0.167017          0.150175
                                0.083598          0.044958
[INPUT] 1    0    [1    /1   ]  0.184696             1
[INPUT] 1    0    [1    /1   ]  0.600621             1
[INPUT] 2    0    [1    /1   ]  0.66934              1
[INPUT] 2    0    [1    /1   ]  2.404278             1
[INPUT] 3    0    [1    /1   ]  1.423104             1

nuclear repulsion = 6.97950789135728
number of shells = 19
number of NR pGTOs = 151
number of NR cGTOs = 55
basis = bfd_vtz
ecp = bfd
CPU time:         0.45


******** <class 'pyscf.dft.roks.ROKS'> ********
method = ROKS-ROHF-RHF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/abenali/Work/WorkShop/qmcpack_workshop_2019/day1_pyscf_molecules/H2O/DFT_BFD/ref_files/tmpeE1zP2
max_memory 4000 MB (current use 63 MB)
num. doubly occ = 4  num. singly occ = 0
XC functionals = b3lyp
radial grids: 
    Treutler-Ahlrichs (JCP 102, 346 (M4)) radial grids
    
becke partition: Becke, JCP, 88, 2547 (1988)
pruning grids: <function nwchem_prune at 0x14a1c61e2b90>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x14a1c61e2aa0>
Set gradient conv threshold to 3.16228e-05
cond(S) = 648.5159118137237
atom H rad-grids = 50, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86
 266 266 266 266 302 302 302 302 302 302 302 302 302 302 302 302 302 266
 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
atom O rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50
  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266
 266 266 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302
 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266
 266 266 266]
tot grids = 34310
Drop grids 2420
    CPU time for setting up grids      0.44 sec, wall time      0.16 sec
nelec by numeric integration = [3.99925237 3.99925237]
    CPU time for vxc      1.67 sec, wall time      0.43 sec
E1 = -40.39862435741031  Ecoul = 20.415768219574353  Exc = -4.034257094355093
init E= -17.0376053408338
    CPU time for initialize scf      4.02 sec, wall time      1.15 sec
  HOMO = -0.440262327531632  LUMO = 0.0181798085023728
  Roothaan mo_energy =
[-1.17309399 -0.63542013 -0.51942024 -0.44026233  0.01817981  0.10480107
  0.38162608  0.39116811  0.43750283  0.58613829  0.63245617  0.738252
  0.81628601  0.92435284  1.04119476  1.2136883   1.51570281  1.53275757
  1.73572333  1.79680264  1.94022804  2.11704845  2.26413887  2.68856981
  2.7265696   2.77085358  2.95629286  2.9856107   3.10286608  3.28511962
  3.67668914  3.75001704  3.78607767  3.86893931  4.00028431  4.02965049
  4.19845313  4.2190459   4.4581421   4.46811171  4.83024027  4.97110278
  5.4023322   5.52338203  5.98180555  6.07524133  6.42300646  6.51348551
  6.56132633  6.56785178  6.68207721  6.99616108  7.13393698  7.59468912
  8.48031672]
nelec by numeric integration = [3.99999832 3.99999832]
    CPU time for vxc      1.95 sec, wall time      0.54 sec
E1 = -42.72170799585984  Ecoul = 23.12778838720293  Exc = -4.525453395305792
cycle= 1 E= -17.1398651126054  delta_E= -0.102  |g|= 0.78  |ddm|= 1.66
    CPU time for cycle= 1      2.23 sec, wall time      0.61 sec
  HOMO = -0.138296051588523  LUMO = 0.0982289687331615
  Roothaan mo_energy =
[-0.83534044 -0.40630011 -0.21094514 -0.13829605  0.09822897  0.20025388
  0.52950964  0.56028671  0.56231989  0.64124995  0.75277192  0.82534262
  0.87505473  1.00524636  1.2291988   1.23806836  1.62864561  1.63414041
  1.92997677  2.00071756  2.15035169  2.30669826  2.52874714  2.84340004
  2.84822379  3.02099097  3.03238444  3.14325282  3.16924945  3.33370033
  3.77780816  3.82910057  3.89897712  3.96554817  4.06058854  4.2815057
  4.29201124  4.39266503  4.48736659  4.62415039  4.91316683  5.14404813
  5.71702839  5.81884696  6.29641597  6.3837316   6.70191877  6.97201662
  7.00683781  7.0107997   7.08677926  7.35350732  7.57258498  7.81949819
  8.9579442 ]
nelec by numeric integration = [3.99999668 3.99999668]
    CPU time for vxc      1.27 sec, wall time      0.33 sec
E1 = -39.304722668126786  Ecoul = 19.146984359450595  Exc = -3.807216259422359
cycle= 2 E= -16.9854466767413  delta_E= 0.154  |g|= 1.19  |ddm|= 1.36
    CPU time for cycle= 2      1.70 sec, wall time      0.43 sec
  HOMO = -0.32044906588967  LUMO = 0.0548250236569299
  Roothaan mo_energy =
[-1.01103264 -0.54028691 -0.39069731 -0.32044907  0.05482502  0.14624783
  0.46093152  0.46140892  0.48261307  0.60490755  0.676147    0.77362694
  0.83936377  0.95989625  1.12503739  1.21893498  1.55959355  1.5674474
  1.82419116  1.88803723  2.03580751  2.19626845  2.37715655  2.77657039
  2.78982258  2.83493973  2.97897262  3.06063763  3.11367549  3.30314515
  3.71806612  3.77471343  3.8327275   3.90508291  4.02022091  4.12954472
  4.22559929  4.2795955   4.46652299  4.52905169  4.86918117  5.03265291
  5.53808819  5.64710058  6.11590955  6.2022183   6.53810614  6.70409667
  6.74795019  6.75444696  6.84389662  7.13980407  7.31045398  7.68352764
  8.66275617]
nelec by numeric integration = [3.99999777 3.99999777]
    CPU time for vxc      1.49 sec, wall time      0.38 sec
E1 = -41.52763681460396  Ecoul = 21.544854667271135  Exc = -4.243263036414742
cycle= 3 E= -17.2465372923903  delta_E= -0.261  |g|= 0.0241  |ddm|= 0.819
    CPU time for cycle= 3      1.85 sec, wall time      0.47 sec
  HOMO = -0.316966422380939  LUMO = 0.0592983734261412
  Roothaan mo_energy =
[-1.00268117 -0.5331928  -0.38943229 -0.31696642  0.05929837  0.15022329
  0.4625014   0.46340379  0.4852924   0.61161106  0.68041842  0.7793531
  0.84626567  0.96586946  1.12945787  1.22489889  1.5659063   1.57293136
  1.82918164  1.89269337  2.04046538  2.2020359   2.38095382  2.78288027
  2.79603657  2.83927537  2.98665151  3.06490932  3.12239222  3.31038661
  3.72479805  3.78430609  3.84059361  3.91123479  4.02711705  4.13742665
  4.23262566  4.28716363  4.47481147  4.53888771  4.87799384  5.04067356
  5.5454749   5.65529232  6.12157093  6.20990239  6.54381446  6.70708849
  6.75042834  6.75882045  6.85012638  7.14294639  7.31499797  7.69354708
  8.66522702]
nelec by numeric integration = [3.99999783 3.99999783]
    CPU time for vxc      1.41 sec, wall time      0.39 sec
E1 = -41.521283855012435  Ecoul = 21.53714150581635  Exc = -4.242002489209898
cycle= 4 E= -17.2466369470487  delta_E= -9.97e-05  |g|= 0.00382  |ddm|= 0.0143
    CPU time for cycle= 4      1.72 sec, wall time      0.47 sec
  HOMO = -0.317357629060264  LUMO = 0.0591083528758234
  Roothaan mo_energy =
[-1.00310259 -0.53335839 -0.38930977 -0.31735763  0.05910835  0.15023632
  0.46286134  0.46342567  0.48559551  0.61142938  0.68033844  0.77922989
  0.84620934  0.96582793  1.12950293  1.22487691  1.56583655  1.57301991
  1.82935507  1.89300278  2.04073978  2.20218949  2.38122627  2.78290883
  2.79602101  2.83892752  2.98657986  3.06500738  3.12222644  3.31046908
  3.72486888  3.78418487  3.84055124  3.91127685  4.02711137  4.13731559
  4.23249255  4.28683417  4.47474929  4.53871755  4.87804353  5.04072026
  5.54545946  5.6550766   6.12168633  6.20964172  6.54416475  6.70711791
  6.75064798  6.75867339  6.84986772  7.14342685  7.31491176  7.6935008
  8.66455995]
nelec by numeric integration = [3.99999783 3.99999783]
    CPU time for vxc      1.64 sec, wall time      0.42 sec
E1 = -41.52340675189403  Ecoul = 21.539816941755948  Exc = -4.242557373969208
cycle= 5 E= -17.24663929275  delta_E= -2.35e-06  |g|= 0.000918  |ddm|= 0.00298
    CPU time for cycle= 5      2.38 sec, wall time      0.60 sec
  HOMO = -0.317330187555995  LUMO = 0.0591180000374667
  Roothaan mo_energy =
[-1.00305568 -0.53332717 -0.38929226 -0.31733019  0.059118    0.15026053
  0.4628472   0.46342039  0.48554624  0.61141849  0.68035523  0.77922229
  0.84618544  0.96580861  1.12949082  1.22485723  1.56584352  1.57301691
  1.82933147  1.89296089  2.0407176   2.20217923  2.38123832  2.78291052
  2.79601141  2.83898557  2.98656179  3.06502414  3.12221207  3.31044421
  3.72484139  3.78417628  3.84053763  3.91126627  4.02710054  4.13739446
  4.23249211  4.28687307  4.47473007  4.53871835  4.8780229   5.04071265
  5.54547117  5.65510952  6.12169596  6.20967157  6.54412803  6.70722149
  6.75071648  6.75877032  6.84997658  7.14343052  7.31500057  7.6935111
  8.66476624]
nelec by numeric integration = [3.99999783 3.99999783]
    CPU time for vxc      1.48 sec, wall time      0.41 sec
E1 = -41.52200035917609  Ecoul = 21.538105709834607  Exc = -4.242252663195524
cycle= 6 E= -17.2466394211797  delta_E= -1.28e-07  |g|= 4.08e-05  |ddm|= 0.000736
    CPU time for cycle= 6      1.97 sec, wall time      0.55 sec
  HOMO = -0.317334116921899  LUMO = 0.0591168655282391
  Roothaan mo_energy =
[-1.00305753 -0.533325   -0.38929442 -0.31733412  0.05911687  0.15026012
  0.46284751  0.46341847  0.48554913  0.61141848  0.6803555   0.77922255
  0.84618592  0.96580925  1.12949162  1.2248576   1.56584293  1.57301644
  1.82933283  1.89296133  2.04071902  2.20217806  2.38123996  2.78290996
  2.79601097  2.83897963  2.9865622   3.06502297  3.12221203  3.3104452
  3.72484198  3.78417551  3.84053801  3.91126638  4.02710099  4.13739324
  4.23249194  4.28687072  4.47473109  4.53871832  4.8780232   5.04071318
  5.54547142  5.65510985  6.12169462  6.20967034  6.54412627  6.70721647
  6.75071082  6.75876537  6.84997429  7.14342606  7.3149956   7.69351087
  8.66475662]
nelec by numeric integration = [3.99999783 3.99999783]
    CPU time for vxc      1.41 sec, wall time      0.41 sec
E1 = -41.52206739092703  Ecoul = 21.538188974292275  Exc = -4.242268896280411
cycle= 7 E= -17.2466394215579  delta_E= -3.78e-10  |g|= 5.73e-06  |ddm|= 5.33e-05
    CPU time for cycle= 7      1.78 sec, wall time      0.50 sec
  HOMO = -0.317332246765101  LUMO = 0.0591177405287839
  Roothaan mo_energy =
[-1.00305514 -0.5333228  -0.3892926  -0.31733225  0.05911774  0.15026127
  0.46284807  0.4634192   0.48554942  0.61141961  0.68035682  0.77922363
  0.84618692  0.96581025  1.12949276  1.2248585   1.56584422  1.5730176
  1.82933391  1.8929623   2.04072016  2.20217944  2.38124158  2.78291136
  2.79601224  2.83898166  2.98656341  3.06502448  3.1222133   3.31044638
  3.72484308  3.78417702  3.84053929  3.91126757  4.02710219  4.13739582
  4.23249326  4.28687256  4.47473226  4.53872001  4.87802459  5.04071472
  5.54547335  5.65511195  6.12169643  6.20967243  6.54412782  6.7072192
  6.75071331  6.75876819  6.8499772   7.14342801  7.3149985   7.69351292
  8.66476021]
nelec by numeric integration = [3.99999783 3.99999783]
    CPU time for vxc      1.39 sec, wall time      0.37 sec
E1 = -41.52204745424204  Ecoul = 21.53816456394426  Exc = -4.242264422614753
Extra cycle  E= -17.2466394215553  delta_E= 2.63e-12  |g|= 7.08e-06  |ddm|= 9.77e-06
    CPU time for scf_cycle     19.49 sec, wall time      5.25 sec
    CPU time for SCF     19.49 sec, wall time      5.25 sec
converged SCF energy = -17.2466394215553
Using Python 2.x
Wavefunction successfully saved to QMCPACK HDF5 Format
Use: "convert4qmc -pyscf  H2O_DFT_BFD.h5" to generate QMCPACK input files
