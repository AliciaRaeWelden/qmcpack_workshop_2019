#!/usr/bin/env python

from pyscf import gto
from pyscf import scf, dft, df

mol = gto.Mole()
mol.verbose = 5
mol.atom =''' 
  H             0.00000000       0.75720000      -0.46920000
  H             0.00000000      -0.75720000      -0.46920000
  O             0.00000000       0.00000000       0.11730000
 '''
mol.unit='A'
mol.basis = {'H': gto.parse('''
H S
23.843185 0.00411490
10.212443 0.01046440
4.374164 0.02801110
1.873529 0.07588620
0.802465 0.18210620
0.343709 0.34852140
0.147217 0.37823130
0.063055 0.11642410
H S
0.029292 1.00000000
H S
0.091791 1.00000000
H S
0.287637 1.00000000
H P
0.106105 1.00000000
H P
0.393954 1.00000000
H P
1.462694 1.00000000
H D
0.295883 1.00000000
H D
1.065841 1.00000000
'''),
'O': gto.parse('''
O S
54.775216 -0.0012444
25.616801 0.0107330
11.980245 0.0018889
6.992317 -0.1742537
2.620277 0.0017622
1.225429 0.3161846
0.577797 0.4512023
0.268022 0.3121534
0.125346 0.0511167
O S
1.686633 1.0000000
O S
0.237997 1.0000000
O P
22.217266 0.0104866
10.74755 0.0366435
5.315785 0.0803674
2.660761 0.1627010
1.331816 0.2377791
0.678626 0.2811422
0.333673 0.2643189
0.167017 0.1466014
0.083598 0.0458145
O P
0.600621 1.0000000
O P
0.184696 1.0000000
O D
2.404278 1.0000000
O D
0.669340 1.0000000
O F
1.423104 1.0000000
''')}
mol.ecp = {'O': gto.basis.parse_ecp('''
O nelec 2
O ul
1 12.30997 6.000000
3 14.76962 73.85984
2 13.71419 -47.87600
O S
2 13.65512 85.86406
'''),
'H':gto.basis.parse_ecp('''
H nelec 0
H ul
1 21.24359508259891 1.00000000000000
3 21.24359508259891 21.24359508259891
2 21.77696655044365 -10.85192405303825
H S
2 1.000000000000000 0.00000000000000
''')
}



mol.spin=0 #Value of S where the spin multiplicity is 2S+1
mol.build()



#Hartree Fock
#mf = scf.ROHF(mol)

#DFT
mf = dft.ROKS(mol)
mf.xc ='b3lyp' 

e_scf=mf.kernel()

#Section for QMCPACK
title="H2O_DFT_NCSU"
from PyscfToQmcpack import savetoqmcpack
savetoqmcpack(mol,mf,title=title)

