#INFO: **** input file is /home/abenali/Work/WorkShop/qmcpack_workshop_2019/day1_pyscf_molecules/H2O/ref_files/HF_AE/h2o_ae_hf.py ****
#!/usr/bin/env python

from pyscf import gto
from pyscf import scf, dft, df

mol = gto.Mole()
mol.verbose = 5
mol.atom =''' 
  H             0.00000000       0.75720000      -0.46920000
  H             0.00000000      -0.75720000      -0.46920000
  O             0.00000000       0.00000000       0.11730000
 '''
mol.unit='A'
mol.basis = 'cc-pvtz'
#mol.pseudo = 'bfd-vtz'
mol.spin=0 #Value of S where the spin multiplicity is 2S+1
mol.build()



#Hartree Fock
mf = scf.ROHF(mol)

#DFT
#mf = dft.ROKS(mol)
#mf.xc ='b3lyp' 

e_scf=mf.kernel()

#Section for QMCPACK
title="H2O_AE_HF"
from PyscfToQmcpack import savetoqmcpack
savetoqmcpack(mol,mf,title=title)

#INFO: ******************** input file end ********************


System: ('Linux', 'abenali', '4.15.0-48-generic', '#51-Ubuntu SMP Wed Apr 3 08:28:49 UTC 2019', 'x86_64', 'x86_64')  Threads 8
Python 2.7.15rc1 (default, Nov 12 2018, 14:31:15) 
[GCC 7.3.0]
numpy 1.14.0  scipy 1.0.0
Date: Sat May 11 20:30:09 2019
PySCF version 1.6.1
PySCF path  /home/abenali/Work/src/pyscf/pyscf
GIT ORIG_HEAD 2cd183cacbe44dc607e325b3aab196fd09b24068
GIT HEAD      ref: refs/heads/dev
GIT dev branch  09e76a37bba1258f387edc9bb3c45eb68014f488

[CONFIG] conf_file None
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 3
[INPUT] num. electrons = 10
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = A
[INPUT]  1 H      0.000000000000   0.757200000000  -0.469200000000 AA    0.000000000000   1.430900621521  -0.886659497646 Bohr
[INPUT]  2 H      0.000000000000  -0.757200000000  -0.469200000000 AA    0.000000000000  -1.430900621521  -0.886659497646 Bohr
[INPUT]  3 O      0.000000000000   0.000000000000   0.117300000000 AA    0.000000000000   0.000000000000   0.221664874411 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] H
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] O
[INPUT] 0    0    [8    /2   ]  15330             0.000508 -0.000115
                                2299              0.003929 -0.000895
                                522.4             0.020243 -0.004636
                                147.3             0.079181 -0.018724
                                47.55             0.230687 -0.058463
                                16.76             0.433118 -0.136463
                                6.207             0.35026 -0.17574
                                0.6882            -0.008154 0.603418
[INPUT] 0    0    [1    /1   ]  1.752                1
[INPUT] 0    0    [1    /1   ]  0.2384               1
[INPUT] 1    0    [3    /1   ]  34.46             0.015928
                                7.749             0.09974
                                2.28              0.310492
[INPUT] 1    0    [1    /1   ]  0.7156               1
[INPUT] 1    0    [1    /1   ]  0.214                1
[INPUT] 2    0    [1    /1   ]  2.314                1
[INPUT] 2    0    [1    /1   ]  0.645                1
[INPUT] 3    0    [1    /1   ]  1.428                1

nuclear repulsion = 9.1895337629349
number of shells = 21
number of NR pGTOs = 74
number of NR cGTOs = 58
basis = cc-pvtz
ecp = {}
CPU time:         0.50


******** <class 'pyscf.scf.rohf.ROHF'> ********
method = ROHF-RHF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/abenali/Work/WorkShop/qmcpack_workshop_2019/day1_pyscf_molecules/H2O/ref_files/HF_AE/tmpCAKoCd
max_memory 4000 MB (current use 63 MB)
num. doubly occ = 5  num. singly occ = 0
Set gradient conv threshold to 3.16228e-05
cond(S) = 2044.3421340798056
E1 = -121.69182152426494  Ecoul = 36.62325968651596
init E= -75.8790280748141
    CPU time for initialize scf      0.59 sec, wall time      0.09 sec
  HOMO = -0.478501506940983  LUMO = 0.0772300349993128
  Roothaan mo_energy =
[-20.77890423  -1.62029368  -0.75344299  -0.59003234  -0.47850151
   0.07723003   0.17015762   0.47868785   0.54481628   0.60070443
   0.70501219   0.72979405   0.76945684   0.84447611   0.92650054
   1.03589239   1.1933506    1.48573477   1.51818782   1.93670803
   1.96594295   1.99305163   2.08666578   2.12883578   2.54546022
   2.89335437   3.32061694   3.46244746   3.55900432   3.64602113
   3.69030334   3.8349243    3.89412224   3.94412649   3.99851582
   4.03331679   4.109621     4.27859301   4.32381478   4.55971315
   4.57704702   4.80854304   5.06541252   5.13261662   5.39700432
   5.90622228   6.44872828   6.74868133   6.76222729   6.8478696
   6.86536519   6.9382165    6.99576616   7.09320339   7.29463162
   7.64537657   8.1550058   12.73676282]
E1 = -124.06099836002012  Ecoul = 38.8509491258473
cycle= 1 E= -76.0205154712379  delta_E= -0.141  |g|= 0.443  |ddm|= 0.709
    CPU time for cycle= 1      0.22 sec, wall time      0.03 sec
  HOMO = -0.428719414197671  LUMO = 0.141396274694549
  Roothaan mo_energy =
[-20.32644794  -1.28217793  -0.66451087  -0.50298007  -0.42871941
   0.14139627   0.2022075    0.55116446   0.59863221   0.69381485
   0.80279394   0.82607956   0.83022182   0.85537876   0.95719274
   1.18054698   1.18726805   1.53903613   1.57645446   2.07624704
   2.07793971   2.10945795   2.1991851    2.2834425    2.58835686
   2.97789555   3.34995796   3.47898284   3.55943661   3.63430451
   3.83405134   3.85461019   3.87248159   3.94093133   4.02947024
   4.08724527   4.21343254   4.31368878   4.43134655   4.58289345
   4.74064382   4.88365371   5.19253648   5.31559971   5.59428787
   6.11922456   6.6224559    7.00716217   7.05254128   7.10634071
   7.1067237    7.13137369   7.27649427   7.31020964   7.55710935
   7.87382      8.35871458  12.95985925]
E1 = -122.4124133894439  Ecoul = 37.175524140546976
cycle= 2 E= -76.047355485962  delta_E= -0.0268  |g|= 0.253  |ddm|= 0.221
    CPU time for cycle= 2      0.39 sec, wall time      0.06 sec
  HOMO = -0.513065450956782  LUMO = 0.138308355707258
  Roothaan mo_energy =
[-20.58642879  -1.35814265  -0.72185594  -0.58626748  -0.51306545
   0.13830836   0.20015824   0.53760548   0.59438211   0.66481931
   0.78312554   0.79460445   0.80006771   0.85445022   0.94993841
   1.12849294   1.19169432   1.51731749   1.55548668   2.0293857
   2.04738024   2.05834181   2.16185666   2.22806863   2.57779358
   2.95193824   3.34493447   3.48022435   3.56907335   3.64469548
   3.78590138   3.86468136   3.87300222   3.94996308   4.00712968
   4.06310601   4.17810685   4.30246672   4.37676855   4.57127128
   4.67238229   4.85133448   5.14208369   5.23974786   5.51499272
   6.03876134   6.5544932    6.90753892   6.92550653   6.99089213
   7.00270211   7.04920145   7.15355062   7.22500933   7.44216453
   7.78064186   8.26840228  12.84940842]
E1 = -123.18188366486113  Ecoul = 37.935444769521496
cycle= 3 E= -76.0569051324047  delta_E= -0.00955  |g|= 0.0319  |ddm|= 0.0712
    CPU time for cycle= 3      0.30 sec, wall time      0.04 sec
  HOMO = -0.503363203746427  LUMO = 0.142168699975382
  Roothaan mo_energy =
[-20.5537102   -1.34501338  -0.70990886  -0.5774951   -0.5033632
   0.1421687    0.20360458   0.54356558   0.60195657   0.66833778
   0.7879995    0.8002704    0.80477246   0.860795     0.95484323
   1.13200832   1.19655246   1.52586397   1.56548873   2.03680337
   2.05307449   2.06559653   2.171096     2.234389     2.58890159
   2.96269805   3.3549045    3.49003966   3.58147446   3.6549732
   3.80020681   3.87776608   3.88370129   3.96039776   4.01825148
   4.07506345   4.19149742   4.31212399   4.38640291   4.58309463
   4.68486513   4.86400914   5.1571195    5.25183058   5.52793379
   6.05133499   6.56926849   6.92313429   6.94303005   7.00254631
   7.02099888   7.06199422   7.1675706    7.23592352   7.45573665
   7.79310053   8.28773276  12.86907938]
E1 = -123.10688147774493  Ecoul = 37.86023620189324
cycle= 4 E= -76.0571115129168  delta_E= -0.000206  |g|= 0.00587  |ddm|= 0.0137
    CPU time for cycle= 4      0.29 sec, wall time      0.04 sec
  HOMO = -0.504148132895276  LUMO = 0.142258317658474
  Roothaan mo_energy =
[-20.55463352  -1.34532068  -0.70956651  -0.57752804  -0.50414813
   0.14225832   0.20397498   0.54402431   0.60220386   0.66837182
   0.78757876   0.80054926   0.80522575   0.86111829   0.95508382
   1.13221086   1.19695467   1.52645507   1.56563559   2.03692013
   2.05324299   2.06585517   2.17130514   2.23435228   2.5898489
   2.96360594   3.3556446    3.49079269   3.58196113   3.6558636
   3.80039335   3.8785635    3.88494761   3.96162486   4.01915294
   4.07603134   4.1922433    4.31284327   4.38727116   4.58394064
   4.68482128   4.86463917   5.15723474   5.25219889   5.52793331
   6.05118372   6.56923096   6.92310611   6.94262316   7.00274529
   7.02047258   7.06225323   7.1677389    7.23629744   7.4559545
   7.79367991   8.28778637  12.86897403]
E1 = -123.10975602815368  Ecoul = 37.863095489216185
cycle= 5 E= -76.0571267760026  delta_E= -1.53e-05  |g|= 0.00103  |ddm|= 0.00606
    CPU time for cycle= 5      0.30 sec, wall time      0.04 sec
  HOMO = -0.504382550380003  LUMO = 0.142210178644522
  Roothaan mo_energy =
[-20.55487234  -1.34539839  -0.70946288  -0.57765122  -0.50438255
   0.14221018   0.20399369   0.54394137   0.60209302   0.66830766
   0.78741878   0.80051076   0.80522546   0.86107706   0.95505646
   1.13217731   1.1968982    1.52642386   1.56557446   2.03687303
   2.05317048   2.06577132   2.17122165   2.23429672   2.58974876
   2.96353076   3.35555454   3.49074324   3.58188196   3.65578703
   3.80027408   3.87843643   3.88491144   3.96157112   4.01912102
   4.0759918    4.19218849   4.31279493   4.38718615   4.58387732
   4.68477248   4.86455225   5.1571526    5.25211874   5.52783297
   6.0511052    6.56917388   6.92300721   6.94246217   7.00264907
   7.02028041   7.06203073   7.16763483   7.23618783   7.45575506
   7.79352373   8.28763026  12.86883862]
E1 = -123.109818657164  Ecoul = 37.86315749312976
cycle= 6 E= -76.0571274010993  delta_E= -6.25e-07  |g|= 0.000178  |ddm|= 0.00102
    CPU time for cycle= 6      0.29 sec, wall time      0.04 sec
  HOMO = -0.504442748881738  LUMO = 0.142204692194152
  Roothaan mo_energy =
[-20.55485714  -1.34541278  -0.7094383   -0.57768405  -0.50444275
   0.14220469   0.20400623   0.54394062   0.60208424   0.66829433
   0.78738611   0.80050854   0.80523747   0.86107457   0.95505357
   1.1321661    1.19689813   1.52643517   1.56557512   2.03685553
   2.05316278   2.06575447   2.17121436   2.23427599   2.58974647
   2.96352833   3.35555143   3.49074387   3.58188219   3.65579011
   3.80026241   3.87843316   3.88492022   3.96157482   4.01912355
   4.0759999    4.19219066   4.31279181   4.38717894   4.58388518
   4.68476202   4.8645518    5.15714872   5.25210887   5.52781962
   6.05108927   6.56916738   6.92299519   6.94244574   7.00263154
   7.02026492   7.06201048   7.16762089   7.23617068   7.45573521
   7.79350764   8.28762142  12.86883757]
E1 = -123.10972995196273  Ecoul = 37.8630687690147
cycle= 7 E= -76.0571274200131  delta_E= -1.89e-08  |g|= 2.46e-05  |ddm|= 0.000182
    CPU time for cycle= 7      0.29 sec, wall time      0.04 sec
  HOMO = -0.504442030789683  LUMO = 0.142205107196615
  Roothaan mo_energy =
[-20.55484836  -1.34540802  -0.70942737  -0.57768061  -0.50444203
   0.14220511   0.2040082    0.54394131   0.60208528   0.66829415
   0.78738393   0.80050965   0.80524073   0.86107573   0.95505472
   1.13216725   1.19689987   1.5264377    1.56557714   2.03685739
   2.05316466   2.06575661   2.17121705   2.2342776    2.58974844
   2.96353088   3.35555366   3.49074611   3.58188445   3.65579271
   3.80026486   3.87843558   3.88492282   3.96157708   4.0191258
   4.07600325   4.19219391   4.31279393   4.38718197   4.58388853
   4.68476499   4.86455467   5.15715216   5.25211246   5.52782328
   6.05109337   6.56917164   6.92300017   6.94245082   7.00263574
   7.02026949   7.06201371   7.16762612   7.23617429   7.45573929
   7.79351174   8.28762561  12.86884236]
E1 = -123.10971518310588  Ecoul = 37.86305399989955
cycle= 8 E= -76.0571274202714  delta_E= -2.58e-10  |g|= 2.19e-06  |ddm|= 2.64e-05
    CPU time for cycle= 8      0.24 sec, wall time      0.03 sec
  HOMO = -0.504441473900793  LUMO = 0.14220524146467
  Roothaan mo_energy =
[-20.5548469   -1.34540749  -0.70942734  -0.57768039  -0.50444147
   0.14220524   0.20400831   0.54394179   0.60208546   0.66829455
   0.78738451   0.8005099    0.80524115   0.86107584   0.95505493
   1.13216776   1.19689995   1.52643803   1.56557742   2.03685792
   2.05316507   2.06575714   2.17121753   2.23427818   2.58974874
   2.96353126   3.35555393   3.49074633   3.58188467   3.65579283
   3.80026547   3.87843591   3.88492282   3.96157722   4.01912597
   4.0760035    4.19219427   4.31279417   4.38718243   4.58388875
   4.6847656    4.86455506   5.15715271   5.25211311   5.527824
   6.05109419   6.56917235   6.92300104   6.94245179   7.00263656
   7.02027042   7.06201444   7.16762705   7.23617502   7.45574015
   7.79351254   8.28762641  12.86884317]
E1 = -123.10971153499806  Ecoul = 37.863050351789546
Extra cycle  E= -76.0571274202736  delta_E= -2.19e-12  |g|= 8.8e-07  |ddm|= 2.65e-06
    CPU time for scf_cycle      3.05 sec, wall time      0.42 sec
    CPU time for SCF      3.06 sec, wall time      0.42 sec
converged SCF energy = -76.0571274202736
Using Python 2.x
Wavefunction successfully saved to QMCPACK HDF5 Format
Use: "convert4qmc -pyscf  H2O_AE_HF.h5" to generate QMCPACK input files
