#INFO: **** input file is /home/abenali/Work/WorkShop/qmcpack_workshop_2019/day1_pyscf_molecules/H2O/DFT_AE/ref_files/h2o_ae_dft.py ****
#!/usr/bin/env python

from pyscf import gto
from pyscf import scf, dft, df

mol = gto.Mole()
mol.verbose = 5
mol.atom =''' 
  H             0.00000000       0.75720000      -0.46920000
  H             0.00000000      -0.75720000      -0.46920000
  O             0.00000000       0.00000000       0.11730000
 '''
mol.unit='A'
mol.basis = 'cc-pvtz'
#mol.pseudo = 'bfd-vtz'
mol.spin=0 #Value of S where the spin multiplicity is 2S+1
mol.build()



#Hartree Fock
#mf = scf.ROHF(mol)

#DFT
mf = dft.ROKS(mol)
mf.xc ='b3lyp' 

e_scf=mf.kernel()

#Section for QMCPACK
title="H2O_AE_DFT"
from PyscfToQmcpack import savetoqmcpack
savetoqmcpack(mol,mf,title=title)

#INFO: ******************** input file end ********************


System: ('Linux', 'abenali', '4.15.0-48-generic', '#51-Ubuntu SMP Wed Apr 3 08:28:49 UTC 2019', 'x86_64', 'x86_64')  Threads 8
Python 2.7.15rc1 (default, Nov 12 2018, 14:31:15) 
[GCC 7.3.0]
numpy 1.14.0  scipy 1.0.0
Date: Sun May 12 00:31:19 2019
PySCF version 1.6.1
PySCF path  /home/abenali/Work/src/pyscf/pyscf
GIT ORIG_HEAD 2cd183cacbe44dc607e325b3aab196fd09b24068
GIT HEAD      ref: refs/heads/dev
GIT dev branch  09e76a37bba1258f387edc9bb3c45eb68014f488

[CONFIG] conf_file None
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 3
[INPUT] num. electrons = 10
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = A
[INPUT]  1 H      0.000000000000   0.757200000000  -0.469200000000 AA    0.000000000000   1.430900621521  -0.886659497646 Bohr
[INPUT]  2 H      0.000000000000  -0.757200000000  -0.469200000000 AA    0.000000000000  -1.430900621521  -0.886659497646 Bohr
[INPUT]  3 O      0.000000000000   0.000000000000   0.117300000000 AA    0.000000000000   0.000000000000   0.221664874411 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] H
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] O
[INPUT] 0    0    [8    /2   ]  15330             0.000508 -0.000115
                                2299              0.003929 -0.000895
                                522.4             0.020243 -0.004636
                                147.3             0.079181 -0.018724
                                47.55             0.230687 -0.058463
                                16.76             0.433118 -0.136463
                                6.207             0.35026 -0.17574
                                0.6882            -0.008154 0.603418
[INPUT] 0    0    [1    /1   ]  1.752                1
[INPUT] 0    0    [1    /1   ]  0.2384               1
[INPUT] 1    0    [3    /1   ]  34.46             0.015928
                                7.749             0.09974
                                2.28              0.310492
[INPUT] 1    0    [1    /1   ]  0.7156               1
[INPUT] 1    0    [1    /1   ]  0.214                1
[INPUT] 2    0    [1    /1   ]  2.314                1
[INPUT] 2    0    [1    /1   ]  0.645                1
[INPUT] 3    0    [1    /1   ]  1.428                1

nuclear repulsion = 9.1895337629349
number of shells = 21
number of NR pGTOs = 74
number of NR cGTOs = 58
basis = cc-pvtz
ecp = {}
CPU time:         0.48


******** <class 'pyscf.dft.roks.ROKS'> ********
method = ROKS-ROHF-RHF
initial guess = minao
damping factor = 0
level shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/abenali/Work/WorkShop/qmcpack_workshop_2019/day1_pyscf_molecules/H2O/DFT_AE/ref_files/tmpu6C51p
max_memory 4000 MB (current use 62 MB)
num. doubly occ = 5  num. singly occ = 0
XC functionals = b3lyp
radial grids: 
    Treutler-Ahlrichs (JCP 102, 346 (M4)) radial grids
    
becke partition: Becke, JCP, 88, 2547 (1988)
pruning grids: <function nwchem_prune at 0x14989efdeb90>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x14989efdeaa0>
Set gradient conv threshold to 3.16228e-05
cond(S) = 2044.3421340798056
atom H rad-grids = 50, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86
 266 266 266 266 302 302 302 302 302 302 302 302 302 302 302 302 302 266
 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
atom O rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50
  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266
 266 266 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302
 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266
 266 266 266]
tot grids = 34310
Drop grids 3707
    CPU time for setting up grids      0.58 sec, wall time      0.08 sec
nelec by numeric integration = [4.99772199 4.99772199]
    CPU time for vxc      1.57 sec, wall time      0.20 sec
E1 = -121.69182152426494  Ecoul = 45.27987145789796  Exc = -9.130436876171846
init E= -76.3528531796039
    CPU time for initialize scf      2.67 sec, wall time      0.36 sec
  HOMO = -0.427171092206619  LUMO = -0.00814779695554004
  Roothaan mo_energy =
[-1.93590613e+01 -1.17166253e+00 -6.24273473e-01 -5.07155198e-01
 -4.27171092e-01 -8.14779696e-03  6.62979444e-02  3.27599192e-01
  3.80149933e-01  4.29678569e-01  4.97807725e-01  5.57683558e-01
  5.90757487e-01  6.54785870e-01  7.38733053e-01  8.31823958e-01
  9.97309841e-01  1.25175198e+00  1.27459251e+00  1.66638710e+00
  1.69141074e+00  1.74063274e+00  1.80701329e+00  1.85309037e+00
  2.20606604e+00  2.54143060e+00  3.01037042e+00  3.15611897e+00
  3.23896229e+00  3.25229767e+00  3.33352328e+00  3.48451130e+00
  3.57019403e+00  3.61739653e+00  3.65123190e+00  3.65459765e+00
  3.67623157e+00  3.95748215e+00  3.97517794e+00  4.18796227e+00
  4.20485468e+00  4.45907454e+00  4.66202035e+00  4.71612315e+00
  4.96827604e+00  5.46945991e+00  5.99648603e+00  6.22989556e+00
  6.23681307e+00  6.34680291e+00  6.40225826e+00  6.47220590e+00
  6.49461477e+00  6.64967023e+00  6.80815852e+00  7.15844927e+00
  7.63602950e+00  1.20425814e+01]
nelec by numeric integration = [4.99999996 4.99999996]
    CPU time for vxc      1.62 sec, wall time      0.21 sec
E1 = -125.1535581303751  Ecoul = 49.2278640080621  Exc = -9.59607706661739
cycle= 1 E= -76.3322374259955  delta_E= 0.0206  |g|= 0.724  |ddm|= 0.732
    CPU time for cycle= 1      1.92 sec, wall time      0.25 sec
  HOMO = -0.141484941354283  LUMO = 0.0535817974438318
  Roothaan mo_energy =
[-18.65593724  -0.854192    -0.41077283  -0.21969984  -0.14148494
   0.0535818    0.12979339   0.40830718   0.44551858   0.56858712
   0.65584075   0.68701571   0.69483058   0.69797683   0.80261658
   1.02052483   1.02156382   1.34312175   1.37537614   1.86436139
   1.86930867   1.89190921   1.97493044   2.06663128   2.29909468
   2.68517255   3.09110204   3.22005771   3.29036113   3.37208635
   3.51781291   3.57523877   3.58729284   3.66645776   3.73960301
   3.79469475   3.90688073   4.04107957   4.11858408   4.29851251
   4.40692629   4.58773108   4.86471815   4.96678086   5.23561184
   5.7591697    6.25215139   6.6233589    6.65267113   6.71071784
   6.71688417   6.74627778   6.87693465   6.93394647   7.15651038
   7.47011655   7.93984575  12.38202693]
nelec by numeric integration = [5. 5.]
    CPU time for vxc      1.67 sec, wall time      0.21 sec
E1 = -119.75064885261726  Ecoul = 43.22948972034849  Exc = -8.87822028323179
cycle= 2 E= -76.2098456525657  delta_E= 0.122  |g|= 1.11  |ddm|= 0.527
    CPU time for cycle= 2      1.75 sec, wall time      0.22 sec
  HOMO = -0.312522913925059  LUMO = 0.0241365873923755
  Roothaan mo_energy =
[-19.13026506  -1.016257    -0.53370343  -0.38667609  -0.31252291
   0.02413659   0.09701504   0.36685573   0.41396048   0.4917445
   0.57850863   0.61956902   0.62300009   0.6762565    0.77275667
   0.92010308   1.00801523   1.2850705    1.31178224   1.76213503
   1.78619271   1.80215815   1.8861649    1.95554378   2.24560943
   2.60668862   3.04691251   3.18633195   3.26148307   3.35054449
   3.37103747   3.52082336   3.57683292   3.64124283   3.6832798
   3.70936234   3.78144565   3.99319955   4.02550972   4.24044851
   4.27802427   4.50786358   4.74411026   4.82051448   5.08210824
   5.59933359   6.10533248   6.40539462   6.40921996   6.49822686
   6.5314098    6.58658189   6.65406198   6.77576242   6.95187234
   7.29437994   7.75349327  12.16441183]
nelec by numeric integration = [4.99999997 4.99999997]
    CPU time for vxc      1.60 sec, wall time      0.20 sec
E1 = -123.22771199481276  Ecoul = 46.93945810570713  Exc = -9.323839311647266
cycle= 3 E= -76.422559437818  delta_E= -0.213  |g|= 0.0287  |ddm|= 0.326
    CPU time for cycle= 3      1.92 sec, wall time      0.25 sec
  HOMO = -0.306553495945868  LUMO = 0.0277108276030383
  Roothaan mo_energy =
[-19.11821086  -1.00639552  -0.525534    -0.38299513  -0.3065535
   0.02771083   0.09985368   0.37098697   0.41963141   0.49463699
   0.58267388   0.62253426   0.62700828   0.68122568   0.77651497
   0.9223238    1.01183257   1.29028482   1.31828431   1.76744323
   1.79126689   1.80691813   1.89303216   1.96002115   2.25328492
   2.61349917   3.05436169   3.19353379   3.27099247   3.35780765
   3.37916704   3.53058679   3.58389638   3.64852751   3.69028268
   3.71644471   3.78867015   3.99980478   4.03140073   4.24760486
   4.28569584   4.51545658   4.75299508   4.82762746   5.09017144
   5.60765146   6.11472106   6.41298959   6.41765832   6.50817065
   6.53753324   6.59409648   6.66081214   6.7821727    6.95838038
   7.30057794   7.76420861  12.17421268]
nelec by numeric integration = [4.99999997 4.99999997]
    CPU time for vxc      1.60 sec, wall time      0.21 sec
E1 = -123.16329816833282  Ecoul = 46.8655741985779  Exc = -9.314514270938687
cycle= 4 E= -76.4227044777587  delta_E= -0.000145  |g|= 0.00508  |ddm|= 0.00986
    CPU time for cycle= 4      1.69 sec, wall time      0.22 sec
  HOMO = -0.306356738770818  LUMO = 0.0275353671085803
  Roothaan mo_energy =
[-19.11726115  -1.00640402  -0.52544491  -0.38236448  -0.30635674
   0.02753537   0.09982377   0.37111737   0.41940996   0.49502433
   0.58295345   0.6229532    0.62704827   0.6810916    0.7765113
   0.92288435   1.01176002   1.29032965   1.3180907    1.76782331
   1.79180809   1.80723409   1.89334051   1.96047374   2.25339883
   2.61377761   3.05439492   3.19340938   3.27057763   3.35761491
   3.37945166   3.53059641   3.5836093    3.64850522   3.69005422
   3.71650048   3.78897269   3.99973875   4.0317674    4.24751986
   4.28578219   4.51540305   4.7529165    4.82807198   5.09052464
   5.60799841   6.11476801   6.41350006   6.41802499   6.50833594
   6.5381785    6.59468731   6.66149148   6.78280649   6.95915632
   7.30141037   7.76425213  12.17446286]
nelec by numeric integration = [4.99999997 4.99999997]
    CPU time for vxc      1.76 sec, wall time      0.23 sec
E1 = -123.15642062822073  Ecoul = 46.857845607183755  Exc = -9.313667746584237
cycle= 5 E= -76.4227090046863  delta_E= -4.53e-06  |g|= 0.000378  |ddm|= 0.0018
    CPU time for cycle= 5      2.05 sec, wall time      0.26 sec
  HOMO = -0.306363334656505  LUMO = 0.0275359078498852
  Roothaan mo_energy =
[-19.1169989   -1.00640535  -0.52545707  -0.38238543  -0.30636333
   0.02753591   0.09982272   0.37109486   0.41940114   0.49501473
   0.58295195   0.62293432   0.62703689   0.68108219   0.77649941
   0.92286176   1.0117483    1.29033185   1.31809955   1.76780782
   1.79177189   1.80720552   1.89331786   1.96045396   2.25338145
   2.61375766   3.05437584   3.19339979   3.27057658   3.35760269
   3.37948157   3.53057448   3.58360147   3.64848563   3.69005664
   3.71651163   3.78900279   3.99972261   4.03174612   4.24751778
   4.28579178   4.51539398   4.7529279    4.82807517   5.09051576
   5.60798504   6.11477821   6.41352551   6.41802906   6.50832736
   6.53816127   6.59464425   6.66150754   6.78278296   6.95913439
   7.3013896    7.76425277  12.17453214]
nelec by numeric integration = [4.99999997 4.99999997]
    CPU time for vxc      1.61 sec, wall time      0.20 sec
E1 = -123.15554224121384  Ecoul = 46.8568450889479  Exc = -9.313545635848667
cycle= 6 E= -76.4227090251797  delta_E= -2.05e-08  |g|= 1.61e-05  |ddm|= 0.000106
    CPU time for cycle= 6      1.88 sec, wall time      0.24 sec
  HOMO = -0.306363234437633  LUMO = 0.0275354036228414
  Roothaan mo_energy =
[-19.11701687  -1.00640505  -0.52545456  -0.38238443  -0.30636323
   0.0275354    0.09982278   0.37109514   0.41940085   0.49501463
   0.582951     0.62293556   0.62703699   0.68108205   0.77649948
   0.92286255   1.01174814   1.29033163   1.31809913   1.76780836
   1.7917728    1.80720661   1.89331802   1.960455     2.25338185
   2.61375851   3.05437576   3.19339963   3.27057534   3.35760234
   3.37947993   3.53057405   3.58360125   3.64848597   3.69005619
   3.71651114   3.7890015    3.99972267   4.03174685   4.24751732
   4.28579136   4.51539388   4.75292722   4.82807491   5.09051599
   5.60798587   6.1147783    6.41352634   6.41802992   6.50832829
   6.53816202   6.5946448    6.66150824   6.78278382   6.95913523
   7.30139036   7.76425332  12.17452765]
nelec by numeric integration = [4.99999997 4.99999997]
    CPU time for vxc      1.69 sec, wall time      0.21 sec
E1 = -123.15555931530993  Ecoul = 46.85686566431654  Exc = -9.313549137173727
cycle= 7 E= -76.4227090252322  delta_E= -5.25e-11  |g|= 1.32e-06  |ddm|= 1.01e-05
    CPU time for cycle= 7      1.97 sec, wall time      0.25 sec
  HOMO = -0.306363271033769  LUMO = 0.0275354664325348
  Roothaan mo_energy =
[-19.11701602  -1.00640494  -0.5254544   -0.3823845   -0.30636327
   0.02753547   0.09982283   0.37109517   0.41940096   0.49501456
   0.58295093   0.6229355    0.62703706   0.68108213   0.77649953
   0.92286244   1.0117482    1.29033171   1.31809925   1.76780832
   1.79177263   1.80720656   1.89331801   1.96045491   2.25338196
   2.61375857   3.05437583   3.19339978   3.27057559   3.35760251
   3.37948003   3.53057415   3.58360148   3.64848609   3.6900564
   3.7165113    3.78900165   3.99972276   4.03174686   4.24751748
   4.28579143   4.51539401   4.75292736   4.82807495   5.09051595
   5.60798588   6.11477847   6.41352639   6.41802986   6.50832835
   6.5381619    6.59464463   6.66150827   6.78278372   6.9591351
   7.30139031   7.76425346  12.17452796]
nelec by numeric integration = [4.99999997 4.99999997]
    CPU time for vxc      1.72 sec, wall time      0.22 sec
E1 = -123.15555926289848  Ecoul = 46.856865533807564  Exc = -9.313549059076694
Extra cycle  E= -76.4227090252327  delta_E= -4.83e-13  |g|= 3.24e-07  |ddm|= 9.51e-07
    CPU time for scf_cycle     17.82 sec, wall time      2.30 sec
    CPU time for SCF     17.82 sec, wall time      2.30 sec
converged SCF energy = -76.4227090252327
Using Python 2.x
Wavefunction successfully saved to QMCPACK HDF5 Format
Use: "convert4qmc -pyscf  H2O_AE_DFT.h5" to generate QMCPACK input files
